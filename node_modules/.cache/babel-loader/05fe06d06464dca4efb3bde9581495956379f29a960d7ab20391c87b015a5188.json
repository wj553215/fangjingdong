{"ast":null,"code":"import Vuex from 'vuex';\nconst setLocalCarList = state => {\n  const {\n    cartList\n  } = state;\n  // 转化为字符串与json\n  const cartListString = JSON.stringify(cartList);\n  localStorage.cartList = cartListString;\n};\nconst getLocalCartList = () => {\n  // JSON.parse转化为对象\n  const cartListString = localStorage.cartList || '{}';\n  return JSON.parse(cartListString);\n};\nexport default Vuex.createStore({\n  state: {\n    // {shopId: {shopName:'沃尔玛',productList:{productId: {} }}}\n    cartList: getLocalCartList()\n    // 第一层级是商铺的id\n    // 第二层是商品id\n    // 第二层内容是商品内容以及购物数量\n    // shopId: {\n    // shopName:'沃尔玛',\n    // productList:{\n    //   productId: {\n    //     _id: '1',\n    //     name: '番茄250g/份',\n    //     imgUrl: 'http://www.dell-lee.com/imgs/vue3/tomato.png',\n    //     sales: 10,\n    //     price: 33.6,\n    //     oldPrice: 39.6,\n    //     count: 2\n    //   },\n    // },\n    // }\n  },\n\n  mutations: {\n    changeCartItemInfo(state, payload) {\n      const {\n        shopId,\n        productId,\n        productInfo\n      } = payload;\n      // let shopInfo = state.cartList[shopId] || {}下两句可这样写\n      let shopInfo = state.cartList[shopId];\n      if (!shopInfo) {\n        shopInfo = {\n          shopName: '',\n          productList: {}\n        };\n      }\n      let product = shopInfo.productList[productId];\n      if (!product) {\n        productInfo.count = 0;\n        product = productInfo;\n      }\n      product.count = product.count + payload.num;\n      if (payload.num > 0) {\n        product.check = true;\n      }\n      if (product.count < 0) {\n        product.count = 0;\n      }\n      shopInfo.productList[productId] = product;\n      state.cartList[shopId] = shopInfo;\n      setLocalCarList(state);\n    },\n    changeShopName(state, payload) {\n      const {\n        shopId,\n        shopName\n      } = payload;\n      let shopInfo = state.cartList[shopId]; // || { shopName: '', productList: {} }\n      if (!shopInfo) {\n        shopInfo = {\n          shopName: '',\n          productList: {}\n        };\n      }\n      shopInfo.shopName = shopName;\n      state.cartList[shopId] = shopInfo;\n      setLocalCarList(state);\n    },\n    changeCartItemChecked(state, payload) {\n      const {\n        shopId,\n        productId\n      } = payload;\n      const product = state.cartList[shopId].productList[productId];\n      product.check = !product.check;\n      setLocalCarList(state);\n    },\n    cleanCartProducts(state, payload) {\n      const {\n        shopId\n      } = payload;\n      state.cartList[shopId].productList = {};\n      setLocalCarList(state);\n    },\n    setCartItemsChecked(state, payload) {\n      const {\n        shopId\n      } = payload;\n      const products = state.cartList[shopId].productList;\n      if (products) {\n        for (const key in products) {\n          const product = products[key];\n          product.check = true;\n        }\n      }\n      setLocalCarList(state);\n    },\n    clearCartData(state, payload) {\n      const {\n        shopId\n      } = payload;\n      state.cartList[shopId].productList = {};\n    }\n  }\n});","map":{"version":3,"names":["Vuex","setLocalCarList","state","cartList","cartListString","JSON","stringify","localStorage","getLocalCartList","parse","createStore","mutations","changeCartItemInfo","payload","shopId","productId","productInfo","shopInfo","shopName","productList","product","count","num","check","changeShopName","changeCartItemChecked","cleanCartProducts","setCartItemsChecked","products","key","clearCartData"],"sources":["D:/WEB/project/jingdong/src/store/index.js"],"sourcesContent":["import Vuex from 'vuex'\n\nconst setLocalCarList = (state) => {\n  const { cartList } = state\n  // 转化为字符串与json\n  const cartListString = JSON.stringify(cartList)\n  localStorage.cartList = cartListString\n}\n\nconst getLocalCartList = () => {\n  // JSON.parse转化为对象\n  const cartListString = localStorage.cartList || '{}'\n  return JSON.parse(cartListString)\n}\n\nexport default Vuex.createStore({\n  state: {\n    // {shopId: {shopName:'沃尔玛',productList:{productId: {} }}}\n    cartList: getLocalCartList()\n    // 第一层级是商铺的id\n    // 第二层是商品id\n    // 第二层内容是商品内容以及购物数量\n    // shopId: {\n    // shopName:'沃尔玛',\n    // productList:{\n    //   productId: {\n    //     _id: '1',\n    //     name: '番茄250g/份',\n    //     imgUrl: 'http://www.dell-lee.com/imgs/vue3/tomato.png',\n    //     sales: 10,\n    //     price: 33.6,\n    //     oldPrice: 39.6,\n    //     count: 2\n    //   },\n    // },\n    // }\n  },\n  mutations: {\n    changeCartItemInfo (state, payload) {\n      const { shopId, productId, productInfo } = payload\n      // let shopInfo = state.cartList[shopId] || {}下两句可这样写\n      let shopInfo = state.cartList[shopId]\n      if (!shopInfo) { shopInfo = { shopName: '', productList: {} } }\n      let product = shopInfo.productList[productId]\n      if (!product) {\n        productInfo.count = 0\n        product = productInfo\n      }\n      product.count = product.count + payload.num\n      if (payload.num > 0) { product.check = true }\n      if (product.count < 0) { product.count = 0 }\n      shopInfo.productList[productId] = product\n      state.cartList[shopId] = shopInfo\n      setLocalCarList(state)\n    },\n    changeShopName (state, payload) {\n      const { shopId, shopName } = payload\n      let shopInfo = state.cartList[shopId] // || { shopName: '', productList: {} }\n      if (!shopInfo) { shopInfo = { shopName: '', productList: {} } }\n      shopInfo.shopName = shopName\n      state.cartList[shopId] = shopInfo\n      setLocalCarList(state)\n    },\n    changeCartItemChecked (state, payload) {\n      const { shopId, productId } = payload\n      const product = state.cartList[shopId].productList[productId]\n      product.check = !product.check\n      setLocalCarList(state)\n    },\n    cleanCartProducts (state, payload) {\n      const { shopId } = payload\n      state.cartList[shopId].productList = {}\n      setLocalCarList(state)\n    },\n    setCartItemsChecked (state, payload) {\n      const { shopId } = payload\n      const products = state.cartList[shopId].productList\n      if (products) {\n        for (const key in products) {\n          const product = products[key]\n          product.check = true\n        }\n      }\n      setLocalCarList(state)\n    },\n    clearCartData (state, payload) {\n      const { shopId } = payload\n      state.cartList[shopId].productList = {}\n    }\n  }\n})\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}